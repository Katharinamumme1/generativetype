<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ALPHABET GENERATOR</title>
    <link rel="stylesheet" href="font.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.4.0/jspdf.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/svg2pdf.js@1.3.6/dist/svg2pdf.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/svg.js/3.0.16/svg.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@svgdotjs/svg.draggable.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@svgdotjs/svg.resize.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@svgdotjs/svg.select.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/gif.js@0.2.0/gif.js"></script>

</head>

<body>
<div id="main-settings" class="banner">
    <div id="color-settings">
        <label for="primary-color"></label>
        <input class="colorPicker" type="color" id="primary-color" value="#ffffff">
        <label for="secondary-color"></label>
        <input class="colorPicker" type="color" id="secondary-color" value="#000000">
        <button id="swap-colors">swap</button>
            <butto>About</button>
    </div>

</div>
<div id="header" class="banner">
    <div class="marquee" class="banner">
        <span>Generative Fonts - Create Your Unique Typeface!</span>
    </div>
</div>





    <!-- Font Section -->
    <section id="fontSection">
        <div id="alphabetContainer"></div>
    </section>


    <div class="font-controls">

        <button id="generateAlphabetButton" class="icon-button"><i class="fas fa-random"></i></button>
    </div>

    <!-- Type Tester Section -->
<section id="typeTesterSection">
<div id="typetester-header" class="banner">
    <div class="marquee" class="banner">
        <span>Gallery- Typetester</span>
    </div>
</div>
    <div class="typetester-container" tabindex="0"></div>
    <div class="typetester-container" tabindex="0"></div>
    <div class="typetester-container" tabindex="0"></div>
    <div class="typetester-container" tabindex="0"></div>
    <div class="typetester-container" tabindex="0"></div>
    <div class="typetester-container" tabindex="0"></div>
    <div class="typetester-container" tabindex="0"></div>
    <div class="typetester-container" tabindex="0"></div>
    <div class="typetester-container" tabindex="0"></div>
    <div class="typetester-container" tabindex="0"></div>
    <div class="typetester-container" tabindex="0"></div>
    <div class="typetester-container" tabindex="0"></div>
    <div class="typetester-container" tabindex="0"></div>
    <div class="typetester-container" tabindex="0"></div>
</section>

    <!-- Letter Section -->
    <section id="letterSection">
        <div class="left-column">
            <div id="carousel" class="carousel">
                <button id="prevLetterButton" class="icon-button"><i class="fas fa-chevron-left"></i></button>
                <div id="carouselInner" class="carousel-inner">
                    <div id="sidePreviewLeft" class="carousel-item side"></div>
                    <div id="largeLetterPreview" class="carousel-item active"></div>
                    <div id="sidePreviewRight" class="carousel-item side"></div>
                </div>
                <button id="nextLetterButton" class="icon-button"><i class="fas fa-chevron-right"></i></button>
            </div>
            <button id="generateLetterButton" class="icon-button"><i class="fas fa-random"></i></button>
        </div>
        <div class="right-column">
            <div id="letterVariationsContainer" class="letter-variations-container"></div>
        </div>
    </section>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.6.0/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <script src="alphabet.js" type="module"></script>
    <script src="letters.js" type="module"></script>
    <script src="color-settings.js"></script>

    <script type="module">
        import { generateAlphabet, generateLetterVariations } from './alphabet.js';
        import { drawLetter } from './letters.js';

        let alphabetSVGs = {};
        let currentLetterIndex = 0;
        const alphabetKeys = [];

        document.addEventListener('DOMContentLoaded', () => {
            alphabetSVGs = generateAlphabet();
            alphabetKeys.push(...Object.keys(alphabetSVGs));
            displayGeneratedAlphabet(alphabetSVGs);
            updateCarousel();
            generateAndDisplayLetterVariations();

            document.getElementById('generateAlphabetButton').addEventListener('click', () => {
                alphabetSVGs = generateAlphabet();
                alphabetKeys.splice(0, alphabetKeys.length, ...Object.keys(alphabetSVGs));
                displayGeneratedAlphabet(alphabetSVGs);
                updateCarousel();
            });

            document.getElementById('prevLetterButton').addEventListener('click', () => navigateLetter(-1));
            document.getElementById('nextLetterButton').addEventListener('click', () => navigateLetter(1));

            document.getElementById('generateLetterButton').addEventListener('click', generateAndDisplayLetterVariations);

            const textCanvasContainer = document.getElementById('textCanvasContainer');
            textCanvasContainer.addEventListener('keydown', handleKeyPress);
            textCanvasContainer.addEventListener('click', () => textCanvasContainer.focus());
        });
document.getElementById('textCanvasContainer').addEventListener('click', () => {
    document.getElementById('textCanvasContainer').focus();
});


    function handleKeyPress(event) {
        console.log("Key pressed:", event.key);
        const textCanvasContainer = document.getElementById('textCanvasContainer');
        if (textCanvasContainer.innerHTML.includes("TYPE SOMETHING")) {
            textCanvasContainer.innerHTML = '';
        }

        const letter = event.key.toUpperCase();
        if (alphabetSVGs[letter]) {
            const letterSVG = alphabetSVGs[letter].cloneNode(true);
            letterSVG.classList.add('letter-svg');
            textCanvasContainer.appendChild(letterSVG);
        } else if (event.key === 'Backspace') {
            textCanvasContainer.lastChild?.remove();
        }
    }



        function displayGeneratedAlphabet(alphabet) {
            const alphabetContainer = document.getElementById('alphabetContainer');
            alphabetContainer.innerHTML = '';
            for (const letter in alphabet) {
                const svg = alphabet[letter];
                svg.dataset.letter = letter;
                alphabetContainer.appendChild(svg);
            }
        }

        function navigateLetter(direction) {
            currentLetterIndex = (currentLetterIndex + direction + alphabetKeys.length) % alphabetKeys.length;
            updateCarousel();
            generateAndDisplayLetterVariations();
        }

        function updateCarousel() {
            const letter = alphabetKeys[currentLetterIndex];
            const prevLetter = alphabetKeys[(currentLetterIndex - 1 + alphabetKeys.length) % alphabetKeys.length];
            const nextLetter = alphabetKeys[(currentLetterIndex + 1) % alphabetKeys.length];

            const largePreviewContainer = document.getElementById('largeLetterPreview');
            const sidePreviewLeft = document.getElementById('sidePreviewLeft');
            const sidePreviewRight = document.getElementById('sidePreviewRight');

            largePreviewContainer.innerHTML = '';
            sidePreviewLeft.innerHTML = '';
            sidePreviewRight.innerHTML = '';

            const largeSVG = alphabetSVGs[letter].cloneNode(true);
            const leftSVG = alphabetSVGs[prevLetter].cloneNode(true);
            const rightSVG = alphabetSVGs[nextLetter].cloneNode(true);

            largeSVG.classList.add('large-letter-svg');
            leftSVG.classList.add('side-letter-svg');
            rightSVG.classList.add('side-letter-svg');

            largePreviewContainer.appendChild(largeSVG);
            sidePreviewLeft.appendChild(leftSVG);
            sidePreviewRight.appendChild(rightSVG);
        }

        function generateAndDisplayLetterVariations() {
            const letter = alphabetKeys[currentLetterIndex];
            const variations = generateLetterVariations(letter);
            const letterVariationsContainer = document.getElementById('letterVariationsContainer');
            letterVariationsContainer.innerHTML = '';
            variations.forEach((variation, index) => {
                letterVariationsContainer.appendChild(variation);
                variation.addEventListener('click', () => {
                    displayLargeLetterPreview(variation);
                });
                if (index === 0) {
                    displayLargeLetterPreview(variation);
                }
            });
        }

        function displayLargeLetterPreview(svgElement) {
            const largePreviewContainer = document.getElementById('largeLetterPreview');
            largePreviewContainer.innerHTML = '';
            const largeSVG = svgElement.cloneNode(true);
            largePreviewContainer.appendChild(largeSVG);
        }

        function makeSVGEditable(svgElement) {
    const draw = SVG(svgElement);

    // Macht jedes Element im SVG draggable
    draw.find('path, line, rect, circle').forEach((el) => {
        el.draggable();
    });

    // Macht die SVG-Elemente resizable
    draw.find('rect, circle, ellipse').forEach((el) => {
        el.resize();
    });

    // Auswahl aktivieren
    draw.select().on('select', (event) => {
        console.log('Selected:', event.target);
    });
}

// FÃ¼ge diese Funktion nach der SVG-Generierung hinzu
function enableEditingInAlphabetContainer() {
    const alphabetContainer = document.getElementById('alphabetContainer');
    const svgs = alphabetContainer.querySelectorAll('svg');

    svgs.forEach((svg) => {
        makeSVGEditable(svg);
    });
}


    </script>

</body>

</html>