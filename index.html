<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ALPHABET GENERATOR</title>
    <link rel="stylesheet" href="font.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.4.0/jspdf.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/svg2pdf.js@1.3.6/dist/svg2pdf.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/svg.js/3.0.16/svg.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@svgdotjs/svg.draggable.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@svgdotjs/svg.resize.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@svgdotjs/svg.select.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/gif.js@0.2.0/gif.js"></script>
</head>

<body>
    <div id="main-settings" class="banner">
        <div id="page_settings">
            <label for="primary-color"></label>
            <input class="colorPicker" type="color" id="primary-color" value="#ffffff">
            <label for="secondary-color"></label>
            <input class="colorPicker" type="color" id="secondary-color" value="#000000">
            <ul class="shadow-button-set">
                <li><button id="swap-colors">swap</button></li>
                <li><button>About</button></li>

                <li><button id="circle-button" class="shape-button">
                    <i class="fas fa-circle"></i>
                </button></li>
                <li><button id="rectangle-button" class="shape-button">
                    <i class="fas fa-square"></i></button></li>
    <li><button id="toggle-outline">Toggle Outline Only</button></li>
                </button></li>
            </ul>
            



        </div>
    </div>

    <div id="header" class="banner">
        <div class="marquee" class="banner">
            <span>Generative Fonts - Create Your Unique Typeface!</span>
        </div>
    </div>

    <!-- Letter Section -->
    <section id="letterSection">
        <div>
            <div id="letterButtonsContainer" class="buttons-container">
                <!-- Buttons for letters will be generated here -->
            </div>
            <button id="generateLetterButton" class="icon-button"><i class="fas fa-random"></i></button>
        </div>
        <div>
            <div id="letterVariationsContainer" class="letter-variations-container"></div>
        </div>
    </section>

    <!-- Font Section -->
    <section id="fontSection">
        <div id="alphabetContainer"></div>
    </section>

    <div class="font-controls">
        <button id="generateAlphabetButton" class="icon-button"><i class="fas fa-random"></i></button>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.6.0/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <script src="alphabet.js" type="module"></script>
    <script src="letters.js" type="module"></script>
    <script src="color-settings.js"></script>

    <script type="module">
        import { generateAlphabet, generateLetterVariations } from './alphabet.js';
        import { drawLetter } from './letters.js';

        let alphabetSVGs = {};
        let currentLetter = null;
        const alphabetKeys = [];

        document.addEventListener('DOMContentLoaded', () => {
            alphabetSVGs = generateAlphabet();
            alphabetKeys.push(...Object.keys(alphabetSVGs));
            displayGeneratedAlphabet(alphabetSVGs);
            createLetterButtons();
            generateAndDisplayLetterVariations();

            document.getElementById('generateAlphabetButton').addEventListener('click', () => {
                alphabetSVGs = generateAlphabet();
                alphabetKeys.splice(0, alphabetKeys.length, ...Object.keys(alphabetSVGs));
                displayGeneratedAlphabet(alphabetSVGs);
                createLetterButtons();
            });

            document.getElementById('generateLetterButton').addEventListener('click', generateAndDisplayLetterVariations);

            const textCanvasContainer = document.getElementById('textCanvasContainer');
            textCanvasContainer.addEventListener('keydown', handleKeyPress);
            textCanvasContainer.addEventListener('click', () => textCanvasContainer.focus());

            // Add event listener for rectangle button
            document.getElementById('rectangle-button').addEventListener('click', () => {
                const svgs = document.querySelectorAll('svg');
                svgs.forEach(svg => {
                    svg.classList.add('no-border-radius');
                });
            });
        });

        function handleKeyPress(event) {
            console.log("Key pressed:", event.key);
            const textCanvasContainer = document.getElementById('textCanvasContainer');
            if (textCanvasContainer.innerHTML.includes("TYPE SOMETHING")) {
                textCanvasContainer.innerHTML = '';
            }

            const letter = event.key.toUpperCase();
            if (alphabetSVGs[letter]) {
                const letterSVG = alphabetSVGs[letter].cloneNode(true);
                letterSVG.classList.add('letter-svg');
                textCanvasContainer.appendChild(letterSVG);
            } else if (event.key === 'Backspace') {
                textCanvasContainer.lastChild?.remove();
            }
        }

        function displayGeneratedAlphabet(alphabet) {
            const alphabetContainer = document.getElementById('alphabetContainer');
            alphabetContainer.innerHTML = '';
            for (const letter in alphabet) {
                const svg = alphabet[letter];
                svg.dataset.letter = letter;
                alphabetContainer.appendChild(svg);
            }
        }

        function createLetterButtons() {
            const buttonsContainer = document.getElementById('letterButtonsContainer');
            buttonsContainer.innerHTML = '';

            alphabetKeys.forEach((letter) => {
                const button = document.createElement('button');
                button.classList.add('letter-button');
                button.textContent = letter;
                button.addEventListener('click', () => {
                    currentLetter = letter;
                    generateAndDisplayLetterVariations();
                });
                buttonsContainer.appendChild(button);
            });
        }

        function generateAndDisplayLetterVariations() {
            if (!currentLetter) return;

            const variations = generateLetterVariations(currentLetter);
            const letterVariationsContainer = document.getElementById('letterVariationsContainer');
            letterVariationsContainer.innerHTML = '';

            variations.forEach((variation) => {
                letterVariationsContainer.appendChild(variation);
            });
        }
    document.getElementById('rectangle-button').addEventListener('click', () => {
        const svgs = document.querySelectorAll('svg');
        svgs.forEach(svg => {
            if (svg.classList.contains('no-border-radius')) {
                svg.classList.remove('no-border-radius');
            } else {
                svg.classList.add('no-border-radius');
            }
        });
    });

    document.getElementById('circle-button').addEventListener('click', () => {
        const svgs = document.querySelectorAll('svg');
        svgs.forEach(svg => {
            svg.classList.remove('no-border-radius'); // Entfernt die Klasse und stellt den ursprünglichen Zustand wieder her
        });
    });


    document.addEventListener('DOMContentLoaded', () => {
        // Generiere und zeige das Alphabet
        alphabetSVGs = generateAlphabet();
        alphabetKeys.push(...Object.keys(alphabetSVGs));
        displayGeneratedAlphabet(alphabetSVGs);

        // Erstelle die Buttons für die Buchstaben
        createLetterButtons();

        // Wähle den ersten Buchstaben aus und zeige Variationen
        if (alphabetKeys.length > 0) {
            currentLetter = alphabetKeys[0]; // Setze den ersten Buchstaben als Standard
            generateAndDisplayLetterVariations(); // Zeige die Variationen für den ersten Buchstaben
        }

        // Event-Listener für Buttons
        document.getElementById('generateAlphabetButton').addEventListener('click', () => {
            alphabetSVGs = generateAlphabet();
            alphabetKeys.splice(0, alphabetKeys.length, ...Object.keys(alphabetSVGs));
            displayGeneratedAlphabet(alphabetSVGs);
            createLetterButtons();
        });

        document.getElementById('generateLetterButton').addEventListener('click', generateAndDisplayLetterVariations);
    });



    </script>

</body>

</html>